# Default values for kagent
replicaCount: 1

global:
  tag: ""

# https://kagent.dev/docs/getting-started/configuring-providers
providers:
  default: openAI
  openAI:
    provider: OpenAI
    model: "gpt-4.1-mini"
    apiKeySecretRef: kagent-openai
    apiKeySecretKey: OPENAI_API_KEY
    apiKey: ""
  ollama:
    provider: Ollama
    model: "llama3.2"
    config:
      host: host.docker.internal:11434
  anthropic:
    provider: Anthropic
    model: "claude-3-sonnet-20240229"
    apiKeySecretRef: kagent-anthropic
    apiKeySecretKey: ANTHROPIC_API_KEY
    apiKey: ""
  azureOpenAI:
    provider: AzureOpenAI
    model: "gpt-4.1-mini"
    apiKeySecretRef: kagent-azure-openai
    apiKeySecretKey: AZUREOPENAI_API_KEY
    apiKey: ""
    config:
      apiVersion: "2023-05-15"
      azureAdToken: ""
      azureDeployment: ""
      azureEndpoint: ""

controller:
  loglevel: "info"

  # -- Namespaces the controller should watch.
  # If empty, the controller will watch ONLY release namespace.
  # @default -- [] (watches release namespace)
  watchNamespaces: []
  #  - watch-ns-1
  #  - watch-ns-2

  image:
    registry: cr.kagent.dev
    repository: kagent-dev/kagent/controller
    tag: "" # Will default to global, then Chart version
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi
  env: [] # Additional environment variables for the controller can be added here

tools:
  loglevel: "debug"
  image:
    registry: cr.kagent.dev
    repository: kagent-dev/kagent/tools
    tag: "" # Will default to global, then Chart version
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 1000m
      memory: 512Mi
  prometheus:
    url: "prometheus.kagent.svc.cluster.local:9090"
    username: ""
    password: ""
  grafana: # kubectl port-forward svc/grafana 3000:3000
    url: "http://grafana.kagent.svc.cluster.local:3000"
    apiKey: ""

# additional tools can be added here
mcp:
  doc2vec:
    enabled: true
    image:
      registry: ghcr.io
      repository: kagent-dev/doc2vec/mcp
      tag: 1.1.7
      pullPolicy: IfNotPresent
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 512Mi

app:
  image:
    registry: cr.kagent.dev
    repository: kagent-dev/kagent/app
    tag: "" # Will default to global, then Chart version
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 1000m
      memory: 1Gi
  env: [] # Additional environment variables for the app can be added here

ui:
  image:
    registry: cr.kagent.dev
    repository: kagent-dev/kagent/ui
    tag: "" # Will default to global, then Chart version
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 1000m
      memory: 1Gi
  env: [] # Additional environment variables for the ui can be added here

service:
  type: ClusterIP
  ports:
    ui:
      port: 80
      targetPort: 8080
    app:
      port: 8081
      targetPort: 8081
    controller:
      port: 8083
      targetPort: 8083
    tools:
      port: 8084
      targetPort: 8084
    querydoc:
      port: 8085
      targetPort: 8085
    oauth2Proxy:
      port: 8090
      targetPort: 8090

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

# -- Override the namespace
# @default -- `.Release.Namespace`
namespaceOverride: ""

podAnnotations: {}

podSecurityContext: {}
  # fsGroup: 2000

securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

otel:
  tracing:
    enabled: false
    exporter:
      otlp:
        endpoint: http://host.docker.internal:4317
        timeout: 15
        insecure: true

k8s-agent:
  enabled: true

kgateway-agent:
  enabled: true

istio-agent:
  enabled: true

promql-agent:
  enabled: true

observability-agent:
  enabled: true

argo-rollouts-agent:
  enabled: true

helm-agent:
  enabled: true

cilium-policy-agent:
  enabled: true

cilium-manager-agent:
  enabled: true

cilium-debug-agent:
  enabled: true


oauth2Proxy:
  enabled: false
  image:
    registry: quay.io
    repository: oauth2-proxy/oauth2-proxy
    tag: "v7.9.0"  # Latest version - confirmed current
    pullPolicy: IfNotPresent
  
  # OAuth2 Provider configuration
  provider: "github"  # github, google, azure, oidc, etc.
  
  # OAuth2 client configuration (typically set via secrets)
  clientId: ""  # Set your GitHub OAuth App Client ID
  clientSecret: ""  # Set your GitHub OAuth App Client Secret  
  cookieSecret: ""  # Generate with: python -c 'import secrets; print(secrets.token_urlsafe(32))'
  
  # OIDC configuration (for generic OIDC providers)
  oidc:
    issuerUrl: ""
    
  # GitHub specific configuration
  github:
    org: "example-org"  # Restrict to specific GitHub org (change this!)
    team: "" # Optional: restrict to specific GitHub team
    
  # Google specific configuration  
  google:
    hostedDomain: "" # Optional: restrict to specific Google Workspace domain
    
  # Azure specific configuration
  azure:
    tenant: ""
    
  # Additional oauth2-proxy configuration
  config:
    # Email domains that are allowed (empty means any)
    emailDomains: []
    # Example: ["example.com", "company.org"]
    
    # Upstream configuration - will be set automatically to point to nginx
    upstreams: ["http://127.0.0.1:8080"]
    
    # Cookie configuration - Financial compliance defaults
    cookieDomain: ""
    cookieSecure: true
    cookieHttpOnly: true
    cookieSameSite: "strict"  # Strict for financial compliance
    cookieExpire: "30m"  # 30 minutes for financial compliance
    
    # Session configuration
    sessionStoreType: "cookie"
    
    # Logging - oauth2-proxy doesn't have --log-level flag
    # logLevel: "info"  # Commented out - not supported
    
    # Skip authentication for specific paths
    skipAuthPaths:
      - "^/ping"
      - "^/health"
      - "^/ready"
    
    # Additional command line arguments - Financial compliance defaults
    extraArgs:
      - "--request-logging=true"
      - "--auth-logging=true"
      - "--standard-logging=true"
      - "--silence-ping-logging=false"
      - "--cookie-csrf-per-request=true"
      - "--cookie-csrf-expire=5m"
    # Additional examples: ["--skip-provider-button", "--pass-basic-auth=false"]
  
  # Resource configuration
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi

  # Environment variables
  env: []
  # Example:
  # - name: OAUTH2_PROXY_CUSTOM_VAR
  #   value: "custom-value"

  # Secret configuration - these should be set via external secrets or values override
  secrets:
    # If true, expects secrets to be provided externally
    # If false, will create secret from values above (not recommended for production)
    external: false  # Set to true in production with external secret management
    secretName: "oauth2-proxy-secrets"
    
    # Keys in the secret
    clientIdKey: "client-id"
    clientSecretKey: "client-secret" 
    cookieSecretKey: "cookie-secret"
