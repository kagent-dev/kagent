{{- $dot := . }}
{{- $providers := omit $dot.Values.providers "default" }}
{{- range $key, $model := $providers }}
---
apiVersion: kagent.dev/v1alpha1
kind: ModelConfig
metadata:
  {{- if eq $dot.Values.providers.default $key }}
  name: default-model-config
  {{- else }}
  name: {{$key | lower}}-model-config
  {{- end }}
  labels:
    {{- include "kagent.labels" $dot | nindent 4 }}
spec:
  {{- with $model }}
  {{- $modelconfig := omit . "provider" "model" "secretKey" "secretName" "apiKey" }}
  provider: {{ .provider | quote }}
  model: {{ .model | quote }}
  {{- if eq .provider "OpenAI"}}
  apiKeySecretKey: {{.secretKey}}
  apiKeySecretRef: {{.secretName}}
  {{- end }}
  {{$key }}:
  {{- toYaml $modelconfig | nindent 4 }}
  {{- end}}
{{- end }}